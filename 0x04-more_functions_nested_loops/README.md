more functions and nested looooooops
